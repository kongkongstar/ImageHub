<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1169px" preserveAspectRatio="none" style="width:1695px;height:1169px;" version="1.1" viewBox="0 0 1695 1169" width="1695px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ofu0zp2eg02p" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class StateBackend--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="73.9102" id="StateBackend" style="stroke: #A80036; stroke-width: 1.5;" width="446" x="538" y="14.5"/><ellipse cx="718.25" cy="30.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M714.6777,26.7651 L714.6777,24.6069 L722.0571,24.6069 L722.0571,26.7651 L719.5918,26.7651 L719.5918,34.8418 L722.0571,34.8418 L722.0571,37 L714.6777,37 L714.6777,34.8418 L717.1431,34.8418 L717.1431,26.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="738.75" y="35.0352">StateBackend</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="539" x2="983" y1="46.5" y2="46.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="539" x2="983" y1="54.5" y2="54.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="306" x="544" y="69.1348">CheckpointStorage createCheckpointStorage(JobID jobId)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="434" x="544" y="82.0898">CompletedCheckpointStorageLocation resolveCheckpoint(String externalPointer)</text><!--class CheckpointStorage--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="48" id="CheckpointStorage" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="861.5" y="337"/><ellipse cx="876.5" cy="353" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M872.9277,349.2651 L872.9277,347.1069 L880.3071,347.1069 L880.3071,349.2651 L877.8418,349.2651 L877.8418,357.3418 L880.3071,357.3418 L880.3071,359.5 L872.9277,359.5 L872.9277,357.3418 L875.3931,357.3418 L875.3931,349.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="107" x="890.5" y="357.5352">CheckpointStorage</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="862.5" x2="999.5" y1="369" y2="369"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="862.5" x2="999.5" y1="377" y2="377"/><!--class CheckpointStorageCoordinatorView--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="86.8652" id="CheckpointStorageCoordinatorView" style="stroke: #A80036; stroke-width: 1.5;" width="651" x="1033.5" y="8"/><ellipse cx="1253.75" cy="24" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1250.1777,20.2651 L1250.1777,18.1069 L1257.5571,18.1069 L1257.5571,20.2651 L1255.0918,20.2651 L1255.0918,28.3418 L1257.5571,28.3418 L1257.5571,30.5 L1250.1777,30.5 L1250.1777,28.3418 L1252.6431,28.3418 L1252.6431,20.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="202" x="1274.25" y="28.5352">CheckpointStorageCoordinatorView</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1034.5" x2="1683.5" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1034.5" x2="1683.5" y1="48" y2="48"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="424" x="1039.5" y="62.6348">CheckpointStorageLocation initializeLocationForCheckpoint(long checkpointId)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="639" x="1039.5" y="75.5898">CheckpointStorageLocation initializeLocationForSavepoint(long checkpointId, @Nullable String externalLocationPointer)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="434" x="1039.5" y="88.5449">CompletedCheckpointStorageLocation resolveCheckpoint(String externalPointer)</text><!--class CheckpointStorageWorkerView--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CheckpointStorageWorkerView" style="stroke: #A80036; stroke-width: 1.5;" width="702" x="6" y="155"/><ellipse cx="265.25" cy="171" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M261.6777,167.2651 L261.6777,165.1069 L269.0571,165.1069 L269.0571,167.2651 L266.5918,167.2651 L266.5918,175.3418 L269.0571,175.3418 L269.0571,177.5 L261.6777,177.5 L261.6777,175.3418 L264.1431,175.3418 L264.1431,167.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="175" x="285.75" y="175.5352">CheckpointStorageWorkerView</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="707" y1="187" y2="187"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="707" y1="195" y2="195"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="690" x="12" y="209.6348">CheckpointStreamFactory resolveCheckpointStorageLocation(long checkpointId,CheckpointStorageLocationReference reference)</text><!--class MemoryBackendCheckpointStorage--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="48" id="MemoryBackendCheckpointStorage" style="stroke: #A80036; stroke-width: 1.5;" width="234" x="814" y="161.5"/><ellipse cx="829" cy="177.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M831.4731,183.6431 Q830.8921,183.9419 830.2529,184.0913 Q829.6138,184.2407 828.9082,184.2407 Q826.4014,184.2407 825.0815,182.5889 Q823.7617,180.937 823.7617,177.8159 Q823.7617,174.6865 825.0815,173.0347 Q826.4014,171.3828 828.9082,171.3828 Q829.6138,171.3828 830.2612,171.5322 Q830.9087,171.6816 831.4731,171.9805 L831.4731,174.7031 Q830.8423,174.1221 830.2488,173.8523 Q829.6553,173.5825 829.0244,173.5825 Q827.6797,173.5825 826.9949,174.6492 Q826.3101,175.7158 826.3101,177.8159 Q826.3101,179.9077 826.9949,180.9744 Q827.6797,182.041 829.0244,182.041 Q829.6553,182.041 830.2488,181.7712 Q830.8423,181.5015 831.4731,180.9204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="202" x="843" y="182.0352">MemoryBackendCheckpointStorage</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="815" x2="1047" y1="193.5" y2="193.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="815" x2="1047" y1="201.5" y2="201.5"/><!--class FsCheckpointStorage--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="48" id="FsCheckpointStorage" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="1083.5" y="161.5"/><ellipse cx="1098.5" cy="177.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1100.9731,183.6431 Q1100.3921,183.9419 1099.7529,184.0913 Q1099.1138,184.2407 1098.4082,184.2407 Q1095.9014,184.2407 1094.5815,182.5889 Q1093.2617,180.937 1093.2617,177.8159 Q1093.2617,174.6865 1094.5815,173.0347 Q1095.9014,171.3828 1098.4082,171.3828 Q1099.1138,171.3828 1099.7612,171.5322 Q1100.4087,171.6816 1100.9731,171.9805 L1100.9731,174.7031 Q1100.3423,174.1221 1099.7488,173.8523 Q1099.1553,173.5825 1098.5244,173.5825 Q1097.1797,173.5825 1096.4949,174.6492 Q1095.8101,175.7158 1095.8101,177.8159 Q1095.8101,179.9077 1096.4949,180.9744 Q1097.1797,182.041 1098.5244,182.041 Q1099.1553,182.041 1099.7488,181.7712 Q1100.3423,181.5015 1100.9731,180.9204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="1112.5" y="182.0352">FsCheckpointStorage</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1084.5" x2="1233.5" y1="193.5" y2="193.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1084.5" x2="1233.5" y1="201.5" y2="201.5"/><!--class CheckpointStreamFactory--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CheckpointStreamFactory" style="stroke: #A80036; stroke-width: 1.5;" width="547" x="500.5" y="566"/><ellipse cx="697.25" cy="582" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M693.6777,578.2651 L693.6777,576.1069 L701.0571,576.1069 L701.0571,578.2651 L698.5918,578.2651 L698.5918,586.3418 L701.0571,586.3418 L701.0571,588.5 L693.6777,588.5 L693.6777,586.3418 L696.1431,586.3418 L696.1431,578.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="145" x="717.75" y="586.5352">CheckpointStreamFactory</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="501.5" x2="1046.5" y1="598" y2="598"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="501.5" x2="1046.5" y1="606" y2="606"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="535" x="506.5" y="620.6348">CheckpointStateOutputStream createCheckpointStateOutputStream(CheckpointedStateScope scope)</text><!--class CheckpointStorageLocation--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CheckpointStorageLocation" style="stroke: #A80036; stroke-width: 1.5;" width="363" x="919.5" y="445"/><ellipse cx="1019.75" cy="461" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1016.1777,457.2651 L1016.1777,455.1069 L1023.5571,455.1069 L1023.5571,457.2651 L1021.0918,457.2651 L1021.0918,465.3418 L1023.5571,465.3418 L1023.5571,467.5 L1016.1777,467.5 L1016.1777,465.3418 L1018.6431,465.3418 L1018.6431,457.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="154" x="1040.25" y="465.5352">CheckpointStorageLocation</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="920.5" x2="1281.5" y1="477" y2="477"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="920.5" x2="1281.5" y1="485" y2="485"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="351" x="925.5" y="499.6348">CheckpointMetadataOutputStream createMetadataOutputStream()</text><!--class CompletedCheckpointStorageLocation--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CompletedCheckpointStorageLocation" style="stroke: #A80036; stroke-width: 1.5;" width="249" x="1305.5" y="687"/><ellipse cx="1320.5" cy="703" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1316.9277,699.2651 L1316.9277,697.1069 L1324.3071,697.1069 L1324.3071,699.2651 L1321.8418,699.2651 L1321.8418,707.3418 L1324.3071,707.3418 L1324.3071,709.5 L1316.9277,709.5 L1316.9277,707.3418 L1319.3931,707.3418 L1319.3931,699.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="217" x="1334.5" y="707.5352">CompletedCheckpointStorageLocation</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1306.5" x2="1553.5" y1="719" y2="719"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1306.5" x2="1553.5" y1="727" y2="727"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="1311.5" y="741.6348">StreamStateHandle getMetadataHandle()</text><!--class FSDataOutputStream--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="48" id="FSDataOutputStream" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="994" y="929"/><ellipse cx="1009" cy="945" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1009.1133,940.5981 L1007.9595,945.6699 L1010.2754,945.6699 Z M1007.6191,938.3569 L1010.6157,938.3569 L1013.9609,950.75 L1011.5122,950.75 L1010.7485,947.687 L1007.4697,947.687 L1006.7227,950.75 L1004.2739,950.75 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="118" x="1023" y="949.5352">FSDataOutputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="995" x2="1143" y1="961" y2="961"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="995" x2="1143" y1="969" y2="969"/><!--class CheckpointStateOutputStream--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CheckpointStateOutputStream" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="795.5" y="808"/><ellipse cx="823.1" cy="824" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M823.2133,819.5981 L822.0595,824.6699 L824.3754,824.6699 Z M821.7191,817.3569 L824.7157,817.3569 L828.0609,829.75 L825.6122,829.75 L824.8485,826.687 L821.5697,826.687 L820.8227,829.75 L818.3739,829.75 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="171" x="839.9" y="828.5352">CheckpointStateOutputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="796.5" x2="1025.5" y1="840" y2="840"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="796.5" x2="1025.5" y1="848" y2="848"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="801.5" y="862.6348">StreamStateHandle closeAndGetHandle();</text><!--class CheckpointMetadataOutputStream--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="CheckpointMetadataOutputStream" style="stroke: #A80036; stroke-width: 1.5;" width="380" x="890" y="687"/><ellipse cx="977.25" cy="703" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M977.3633,698.5981 L976.2095,703.6699 L978.5254,703.6699 Z M975.8691,696.3569 L978.8657,696.3569 L982.2109,708.75 L979.7622,708.75 L978.9985,705.687 L975.7197,705.687 L974.9727,708.75 L972.5239,708.75 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="197" x="997.75" y="707.5352">CheckpointMetadataOutputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="891" x2="1269" y1="719" y2="719"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="891" x2="1269" y1="727" y2="727"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="368" x="896" y="741.6348">CompletedCheckpointStorageLocation closeAndFinalizeCheckpoint()</text><!--class StreamStateHandle--><rect fill="#FEFECE" filter="url(#f1ofu0zp2eg02p)" height="60.9551" id="StreamStateHandle" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="951" y="1098"/><ellipse cx="1000.25" cy="1114" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M996.6777,1110.2651 L996.6777,1108.1069 L1004.0571,1108.1069 L1004.0571,1110.2651 L1001.5918,1110.2651 L1001.5918,1118.3418 L1004.0571,1118.3418 L1004.0571,1120.5 L996.6777,1120.5 L996.6777,1118.3418 L999.1431,1118.3418 L999.1431,1110.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="109" x="1020.75" y="1118.5352">StreamStateHandle</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="952" x2="1166" y1="1130" y2="1130"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="952" x2="1166" y1="1138" y2="1138"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="957" y="1152.6348">FSDataInputStream openInputStream()</text><!--link StateBackend to CheckpointStorage--><path d="M763.227,88.6944 C766.581,123.3454 774.9796,175.591 796,216 C820.6851,263.454 865.1993,306.7638 896.3407,333.4518 " fill="none" id="StateBackend-CheckpointStorage" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="900.4514,336.9449,896.1835,328.0688,896.6413,333.7071,891.003,334.1649,900.4514,336.9449" style="stroke: #A80036; stroke-width: 1.0;"/><!--link MemoryBackendCheckpointStorage to CheckpointStorage--><path d="M931,209.5345 C931,237.0266 931,282.6219 931,316.6171 " fill="none" id="MemoryBackendCheckpointStorage-CheckpointStorage" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="938.0001,316.9748,931,336.9748,924.0001,316.9747,938.0001,316.9748" style="stroke: #A80036; stroke-width: 1.0;"/><!--link FsCheckpointStorage to CheckpointStorage--><path d="M1127.7756,209.5345 C1089.1682,239.2521 1023.08,290.1227 978.2509,324.6292 " fill="none" id="FsCheckpointStorage-CheckpointStorage" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="982.3306,330.3225,962.2123,336.9748,973.7911,319.2285,982.3306,330.3225" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageCoordinatorView to CheckpointStorage--><path d="M1329.8791,113.2623 C1311.4191,147.1282 1284.8314,187.8267 1252,216 C1177.5169,279.9154 1070.2531,320.6821 1000.5896,342.2031 " fill="none" id="CheckpointStorageCoordinatorView-CheckpointStorage" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1323.8151,109.7526,1339.2865,95.2738,1336.221,116.2405,1323.8151,109.7526" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageWorkerView to CheckpointStorage--><path d="M476.2392,221.9573 C592.6922,257.5627 765.9298,310.5299 861.4675,339.7405 " fill="none" id="CheckpointStorageWorkerView-CheckpointStorage" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="474.0624,228.6117,456.9832,216.0698,478.1559,215.2235,474.0624,228.6117" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageLocation to CheckpointStreamFactory--><path d="M1018.4841,506.0334 C975.0129,522.1191 921.3233,541.9859 875.3406,559.0009 " fill="none" id="CheckpointStorageLocation-CheckpointStreamFactory" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="877.6758,565.6006,856.4895,565.9764,872.8173,552.4706,877.6758,565.6006" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageWorkerView to CheckpointStreamFactory--><path d="M388.0021,216.056 C463.9952,290.9557 659.1527,483.3052 739.076,562.0785 " fill="none" id="CheckpointStorageWorkerView-CheckpointStreamFactory" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="742.7938,565.7428,739.1917,556.5763,739.2327,562.233,733.576,562.274,742.7938,565.7428" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageCoordinatorView to CheckpointStorageLocation--><path d="M1348.793,95.0656 C1339.7787,129.2166 1324.817,177.2757 1304,216 C1256.4512,304.4513 1178.6453,393.631 1134.446,440.9397 " fill="none" id="CheckpointStorageCoordinatorView-CheckpointStorageLocation" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1130.7994,444.8293,1139.873,440.9992,1134.2191,441.1816,1134.0367,435.5277,1130.7994,444.8293" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageCoordinatorView to CompletedCheckpointStorageLocation--><path d="M1381.4648,95.0426 C1402.2656,139.456 1430,210.9621 1430,276.5 C1430,276.5 1430,276.5 1430,475.5 C1430,548.8717 1430,634.7564 1430,681.9376 " fill="none" id="CheckpointStorageCoordinatorView-CompletedCheckpointStorageLocation" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1430,686.9385,1434,677.9385,1430,681.9385,1426,677.9385,1430,686.9385" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStateOutputStream to FSDataOutputStream--><path d="M953.3411,869.1839 C973.6522,883.903 998.1172,901.6324 1019.3054,916.9871 " fill="none" id="CheckpointStateOutputStream-FSDataOutputStream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1023.7233,911.5438,1035.8103,928.948,1015.508,922.8801,1023.7233,911.5438" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointMetadataOutputStream to FSDataOutputStream--><path d="M1078.5619,748.2875 C1076.6465,789.2953 1073.246,862.0971 1071.0589,908.9206 " fill="none" id="CheckpointMetadataOutputStream-FSDataOutputStream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1078.0475,909.3313,1070.1218,928.9829,1064.0627,908.678,1078.0475,909.3313" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStreamFactory to CheckpointStateOutputStream--><path d="M791.3511,627.1495 C816.8104,672.1214 864.1707,755.7797 891.0391,803.2406 " fill="none" id="CheckpointStreamFactory-CheckpointStateOutputStream" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="893.5739,807.7181,892.6209,797.9155,891.1106,803.367,885.6591,801.8567,893.5739,807.7181" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStorageLocation to CheckpointMetadataOutputStream--><path d="M1098.3403,506.1495 C1094.4536,550.94 1087.2367,634.1057 1083.1097,681.6648 " fill="none" id="CheckpointStorageLocation-CheckpointMetadataOutputStream" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1082.6712,686.7181,1087.4346,678.0978,1083.1036,681.7368,1079.4646,677.4059,1082.6712,686.7181" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CheckpointStateOutputStream to StreamStateHandle--><path d="M924.6626,869.0233 C937.4591,897.2634 957.3546,940.2938 976,977 C996.5188,1017.3943 1021.7244,1062.8721 1038.9399,1093.3667 " fill="none" id="CheckpointStateOutputStream-StreamStateHandle" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1041.4204,1097.7548,1040.4736,1087.9516,1038.9599,1093.4021,1033.5093,1091.8884,1041.4204,1097.7548" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CompletedCheckpointStorageLocation to StreamStateHandle--><path d="M1402.4178,748.056 C1334.9418,822.8071 1161.8669,1014.5424 1090.4959,1093.6083 " fill="none" id="CompletedCheckpointStorageLocation-StreamStateHandle" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1086.7638,1097.7428,1095.7635,1093.7422,1090.1141,1094.0312,1089.825,1088.3818,1086.7638,1097.7428" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml checkpoint storage
interface StateBackend {
    CheckpointStorage createCheckpointStorage(JobID jobId)
    CompletedCheckpointStorageLocation resolveCheckpoint(String externalPointer)
}

interface CheckpointStorage

StateBackend ....> CheckpointStorage

interface CheckpointStorageCoordinatorView {
    CheckpointStorageLocation initializeLocationForCheckpoint(long checkpointId)
    CheckpointStorageLocation initializeLocationForSavepoint(long checkpointId, @Nullable String externalLocationPointer)
    CompletedCheckpointStorageLocation resolveCheckpoint(String externalPointer)
}
interface CheckpointStorageWorkerView {
    CheckpointStreamFactory resolveCheckpointStorageLocation(long checkpointId,CheckpointStorageLocationReference reference)
}

class MemoryBackendCheckpointStorage
class FsCheckpointStorage

MemoryBackendCheckpointStorage ...|> CheckpointStorage
FsCheckpointStorage ...|> CheckpointStorage

CheckpointStorageCoordinatorView <|- - - CheckpointStorage
CheckpointStorageWorkerView <|- - - CheckpointStorage

interface CheckpointStreamFactory {
    CheckpointStateOutputStream createCheckpointStateOutputStream(CheckpointedStateScope scope)
}
interface CheckpointStorageLocation {
    CheckpointMetadataOutputStream createMetadataOutputStream()
}

CheckpointStorageLocation - -|> CheckpointStreamFactory
CheckpointStorageWorkerView .....> CheckpointStreamFactory
CheckpointStorageCoordinatorView .....> CheckpointStorageLocation


interface CompletedCheckpointStorageLocation {
    StreamStateHandle getMetadataHandle()
}
CheckpointStorageCoordinatorView ......> CompletedCheckpointStorageLocation

abstract class FSDataOutputStream
abstract class CheckpointStateOutputStream {
    StreamStateHandle closeAndGetHandle();
}
abstract class CheckpointMetadataOutputStream {
    CompletedCheckpointStorageLocation closeAndFinalizeCheckpoint() 
}

CheckpointStateOutputStream - -|> FSDataOutputStream
CheckpointMetadataOutputStream - -|> FSDataOutputStream


CheckpointStreamFactory ...> CheckpointStateOutputStream
CheckpointStorageLocation ...> CheckpointMetadataOutputStream

interface StreamStateHandle {
    FSDataInputStream openInputStream()
}

CheckpointStateOutputStream ....> StreamStateHandle
CompletedCheckpointStorageLocation ....> StreamStateHandle
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_181-b13
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: US-ASCII
Language: en
Country: CN
--></g></svg>